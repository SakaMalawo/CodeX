import os
from openai import OpenAI
from dotenv import load_dotenv

load_dotenv()  #ity ny chragement an'ilay fichier .env 

client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))

print("ğŸ¤– Bonjour, je suis Haybot !")
print("Pose-moi une question dans nâ€™importe quelle matiÃ¨re scolaire.")
print("Tape 'exit' pour quitter.\n")

history = []

while True:
    user_input = input("Ta question : ")

    if user_input.lower() in ["exit", "quit"]:
        print("ğŸ‘‹ Ã€ bientÃ´t !")
        break

    response = client.chat.completions.create(
        model="gpt-4",  
        messages=[
            {"role": "system", "content": "Tu t'appelles Haybot et tu n'es pas un professeur mais un collÃ¨gue patient et pÃ©dagogue qui aide les Ã©lÃ¨ves et les Ã©tudiants. RÃ©ponds avec des explications claires et detaillÃ©es adaptÃ©es aux Ã©lÃ¨ves."},
            *history,
            {"role": "user", "content": user_input}
        ]
    )

    answer = response.choices[0].message.content
    print(f"\nğŸ¤– Haybot :", answer, "\n")

    history.append({"role": "user", "content": user_input})
    history.append({"role": "assistant", "content": answer})
